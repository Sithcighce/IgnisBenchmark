# 07 第七次尝试：SiliconFlow双模型测试

**批次编号**: 07  
**时间**: 2025-10-15 00:18 - 07:42  
**供应商**: SiliconFlow API（中转服务）  
**状态**: ⚠️ 失败（供应商API并发限制）  
**完成率**: V3 11.1% / V3.2 18.1%

---

## 📋 核心问题

**供应商API并发限制是瓶颈，非模型或Prompt问题**

- 配置: 20并发workers
- API: https://api.siliconflow.cn/v1
- 现象: 大量429错误（Rate Limit Exceeded）
- 完成率: 极低（11.1-18.1%）

---

## 🧪 三阶段测试

### 阶段0: 早期测试 (00:18-00:25)

- **脚本**: `test_batch_2files.py`
- **测试**: 2篇论文
- **结果**: 100%成功
- **输出**: `data/questions_test/`
- **目的**: 验证脚本可行性

### 阶段1: Pro V3 + 英文 (07:21)

- **模型**: `openai/Pro/deepseek-ai/DeepSeek-V3`
- **Prompt**: 英文
- **论文数**: 298篇
- **并发**: 20 workers
- **结果**: ❌ 33/298 = **11.1%**
- **输出**: `data/questions_v3/`

### 阶段2: Exp V3.2 + 中文 (07:42) ⏰ 仅21分钟后！

- **模型**: `openai/deepseek-ai/DeepSeek-V3.2-Exp`
- **Prompt**: 中文
- **论文数**: 199篇
- **并发**: 20 workers
- **结果**: ❌ 36/199 = **18.1%**
- **输出**: `data/questions_v32/`

---

## 📂 目录结构

```
07_批量详细题目_最早批次/
├── data/
│   ├── questions_test/    # 早期测试(2篇,100%)
│   ├── questions_v3/      # V3英文(33/298,11.1%)
│   └── questions_v32/     # V3.2中文(36/199,18.1%)
├── scripts/
│   ├── batch_detail_q_generator.py
│   └── test_batch_2files.py
├── prompts/
│   ├── generation_prompt.md
│   └── quality_check_prompt.md
└── logs/ (9个日志文件)
```

---

## 💡 核心发现

### 1. 供应商 > 模型版本

- V3 (11.1%) vs V3.2 (18.1%) - 差异很小
- 都失败，说明不是模型问题

### 2. Prompt语言影响小

- 英文 (11.1%) vs 中文 (18.1%) - 差异很小
- 都失败，说明不是语言问题

### 3. 21分钟快速迭代的价值

- 07:21 V3开始
- 07:42 V3.2开始
- **快速验证假设，精准定位问题**

### 4. SiliconFlow限制推测

- RPM: ~60/分钟
- TPM: ~100,000 tokens/分钟
- 20并发远超限制

---

## 📊 失败原因分布

通过日志分析：

- 429 Rate Limit: ~80%
- Timeout: ~10%
- Other API Errors: ~5%
- Success: ~11-18%

---

## 🎯 经验教训

### ✅ 成功之处

1. **快速迭代**: 21分钟验证两个假设
2. **小规模测试**: test阶段100%成功证明脚本可行
3. **精准定位**: 排除模型和语言因素，锁定API问题

### ⚠️ 失败原因

1. **供应商选择失误**: SiliconFlow中转服务不适合批量
2. **并发过高**: 20并发超出限制
3. **无降级策略**: 429错误后无有效重试

### 🔄 后续改进（批次08）

1. **换用DeepSeek官方API** → 76.5%成功率
2. 降低或优化并发
3. 实现智能重试机制

---

## 🔗 数据流向

```
输入: 298+199篇论文
  ↓
阶段0: Test(2篇) → 100%
  ↓
阶段1: V3(298篇) → 11.1%
  ↓
阶段2: V3.2(199篇) → 18.1%
  ↓
结论: SiliconFlow API是瓶颈
  ↓
批次08: 换用DeepSeek官方API → 76.5%
```

---

## 📖 相关批次

- **上游**: 批次06（单篇深度测试）
- **下游**: 批次08（DeepSeek官方，76.5%）
- **关键决策**: 07的失败促使08换API，成为转折点

---

**生成时间**: 2025-10-15  
**文档更新**: 2025-10-17  
**下一步**: 批次08 - DeepSeek官方API
