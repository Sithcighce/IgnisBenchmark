# æ™ºèƒ½é¢˜åº“ç”Ÿæˆä¸è¯„ä¼°ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºå¤§æ¨¡å‹çš„è‡ªåŠ¨åŒ–é¢˜åº“ç”Ÿæˆç³»ç»Ÿï¼Œé‡‡ç”¨**åŒé‡èµ„äº§ç§¯ç´¯**æœºåˆ¶æ„å»ºé«˜è´¨é‡é¢˜åº“ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ åŒé‡èµ„äº§ç§¯ç´¯ (Dual Asset Accumulation)

ç³»ç»Ÿé‡‡ç”¨åˆ›æ–°çš„åŒæ•°æ®åº“æ¶æ„ï¼Œå®ç°é¢˜åº“èµ„äº§çš„åŒå‘ç§¯ç´¯ï¼š

- **ğŸ“š é”™é¢˜åº“ (Benchmark Bank)**: æ”¶é›†ç›®æ ‡æ¨¡å‹ï¼ˆå¦‚Qwen-8Bï¼‰**ç­”é”™**çš„é¢˜ç›®ï¼Œå½¢æˆä¸“é—¨çš„æŒ‘æˆ˜æ€§benchmark
  - æ–‡ä»¶: `data/benchmark_bank.jsonl`
  - ç”¨é€”: è¯„ä¼°æ¨¡å‹å¼±ç‚¹ã€è®­ç»ƒæ•°æ®å¢å¼ºã€èƒ½åŠ›è¾¹ç•Œæµ‹è¯•
  - åŒ…å«: é¢˜ç›®æ•°æ® + é”™è¯¯ç­”æ¡ˆ + åˆ¤é¢˜ç»“æœ

- **âœ… éªŒè¯é›† (Validation Set)**: æ”¶é›†ç›®æ ‡æ¨¡å‹**ç­”å¯¹**çš„é¢˜ç›®ï¼Œå½¢æˆå¯é çš„éªŒè¯æ•°æ®é›†
  - æ–‡ä»¶: `data/validation_set.jsonl`
  - ç”¨é€”: æ¨¡å‹æ€§èƒ½éªŒè¯ã€è´¨é‡æ§åˆ¶ã€Few-shotç¤ºä¾‹æ± 
  - åŒ…å«: é«˜è´¨é‡é¢˜ç›®åŠæ ‡å‡†ç­”æ¡ˆ

### ï¿½ è‡ªåŠ¨åŒ–å·¥ä½œæµ

```
ç”Ÿæˆé¢˜ç›® (Gemini 2.5 Pro) 
    â†“
è§£ç­”é¢˜ç›® (æœ¬åœ° Qwen-8B via LM Studio)
    â†“
æ™ºèƒ½åˆ¤é¢˜ (Gemini 2.5 Flash)
    â†“
    â”œâ”€â†’ [ç­”é”™] â†’ é”™é¢˜åº“ (å«é”™è¯¯ç­”æ¡ˆåˆ†æ)
    â””â”€â†’ [ç­”å¯¹] â†’ éªŒè¯é›† (å¯ç”¨ä½œFew-shot)
```

### ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿

- **æ™ºèƒ½æç¤ºç®¡ç†**: æ‰€æœ‰Promptç‹¬ç«‹å­˜å‚¨åœ¨`docs/`ç›®å½•ï¼Œæ”¯æŒçƒ­æ›´æ–°æ— éœ€æ”¹ä»£ç 
- **æˆæœ¬å¯æ§**: APIè°ƒç”¨å‰é¢„ä¼°æˆæœ¬ï¼Œæ”¯æŒå®æ—¶æˆæœ¬è¿½è¸ª
- **é«˜è´¨é‡ä¿è¯**: åŠ¨æ€Few-shotç­–ç•¥ï¼Œåˆ©ç”¨éªŒè¯é›†ä¸­çš„ä¼˜è´¨é¢˜ç›®æå‡ç”Ÿæˆè´¨é‡
- **æ•°æ®é©±åŠ¨**: åŒå‘ç§¯ç´¯æœºåˆ¶ç¡®ä¿æŒç»­äº§å‡ºæœ‰ä»·å€¼çš„æ•°æ®èµ„äº§

## å¿«é€Ÿå¼€å§‹

### å‰ææ¡ä»¶

âœ… **å·²å®Œæˆ**:
- Python 3.13.4 è™šæ‹Ÿç¯å¢ƒ
- æ‰€æœ‰ä¾èµ–åŒ…ï¼ˆlitellm, flaskç­‰ï¼‰
- Google APIå¯†é’¥é…ç½®
- LM Studio (qwen3-8bæ¨¡å‹)
## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

```powershell
# 1. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.\.venv\Scripts\Activate.ps1

# 2. å®‰è£…ä¾èµ–ï¼ˆå¦‚æœªå®‰è£…ï¼‰
pip install -r requirements.txt

# 3. é…ç½®ç¯å¢ƒå˜é‡
# å¤åˆ¶ .env.example ä¸º .envï¼Œå¡«å…¥ Google API Key
cp .env.example .env

# 4. åˆå§‹åŒ–ç§å­æ•°æ®ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
Copy-Item data/seed_examples.jsonl data/benchmark_bank.jsonl
```

### å¯åŠ¨ LM Studio

ç¡®ä¿ LM Studio å·²è¿è¡Œå¹¶åŠ è½½ `qwen3-8b` æ¨¡å‹ï¼Œç›‘å¬ `http://localhost:1234`ã€‚

### è¿è¡Œç¨‹åº

```powershell
# æ–¹å¼1: å•æ¬¡è¿è¡Œï¼ˆç”Ÿæˆ3é¢˜ï¼‰
python main.py

# æ–¹å¼2: æ‰¹é‡è¿è¡Œï¼ˆ5ä¸ªå‘¨æœŸï¼Œæ¯å‘¨æœŸ3é¢˜ï¼‰
python tools/batch_run.py --cycles 5 --questions 3

# æ–¹å¼3: Webç›‘æ§ç•Œé¢
python web_ui.py
# è®¿é—® http://localhost:5000 æŸ¥çœ‹å®æ—¶çŠ¶æ€

# å¯é€‰: ä½¿ç”¨PowerShellå¯åŠ¨è„šæœ¬
scripts\run.ps1      # è¿è¡Œä¸»ç¨‹åº
scripts\run_web.ps1  # å¯åŠ¨Webç•Œé¢
```

### æ•°æ®åˆ†æ

```powershell
# æŸ¥çœ‹åŒæ•°æ®åº“ç»Ÿè®¡æŠ¥å‘Š
python tools/analyze_data.py

# è¿è¡Œç³»ç»Ÿæµ‹è¯•
python testscript/test_setup.py
```

## é¡¹ç›®ç»“æ„

```
questions/
â”œâ”€â”€ config.yaml                 # ç³»ç»Ÿé…ç½®
â”œâ”€â”€ .env                        # APIå¯†é’¥ï¼ˆä¸æäº¤Gitï¼‰
â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºï¼ˆå•æ¬¡è¿è¡Œï¼‰
â”œâ”€â”€ web_ui.py                   # Webç›‘æ§ç•Œé¢
â”‚
â”œâ”€â”€ src/                        # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ models.py               # æ•°æ®æ¨¡å‹ï¼ˆQuestionUnit, BenchmarkEntryç­‰ï¼‰
â”‚   â”œâ”€â”€ prompt_manager.py       # æç¤ºè¯ç®¡ç†å™¨
â”‚   â”œâ”€â”€ question_generator.py   # é¢˜ç›®ç”Ÿæˆï¼ˆGemini 2.0 Flashï¼‰
â”‚   â”œâ”€â”€ answering_module.py     # è§£ç­”æ¨¡å—ï¼ˆLM Studioï¼‰
â”‚   â”œâ”€â”€ grading_module.py       # åˆ¤é¢˜æ¨¡å—ï¼ˆGemini 2.0 Flashï¼‰
â”‚   â”œâ”€â”€ data_persistence.py     # åŒæ•°æ®åº“æŒä¹…åŒ–
â”‚   â”œâ”€â”€ config_loader.py        # é…ç½®åŠ è½½
â”‚   â””â”€â”€ utils.py                # å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ seed_examples.jsonl     # ç§å­ç¤ºä¾‹ï¼ˆGitè¿½è¸ªï¼Œä¾›æ–°ç”¨æˆ·ä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ benchmark_bank.jsonl    # é”™é¢˜åº“ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼Œä¸æäº¤Gitï¼‰
â”‚   â””â”€â”€ validation_set.jsonl    # éªŒè¯é›†ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼Œä¸æäº¤Gitï¼‰
â”‚
â”œâ”€â”€ tools/                      # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ batch_run.py            # æ‰¹é‡è¿è¡Œ
â”‚   â””â”€â”€ analyze_data.py         # æ•°æ®åˆ†æ
â”‚
â”œâ”€â”€ scripts/                    # å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ run.ps1                 # è¿è¡Œä¸»ç¨‹åº
â”‚   â””â”€â”€ run_web.ps1             # å¯åŠ¨Webç›‘æ§
â”‚
â”œâ”€â”€ testscript/                 # æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ test_setup.py           # ç¯å¢ƒæµ‹è¯•
â”‚
â”œâ”€â”€ docs/                       # æ–‡æ¡£ä¸æç¤ºè¯
â”‚   â”œâ”€â”€ å®è§‚è®¾è®¡.md
â”‚   â”œâ”€â”€ å®ç°ç»†èŠ‚.md
â”‚   â”œâ”€â”€ å¼€å‘å‡†åˆ™.md
â”‚   â”œâ”€â”€ ç”Ÿæˆé¢˜Prompt.md         # é¢˜ç›®ç”Ÿæˆæç¤ºè¯
â”‚   â”œâ”€â”€ åˆ¤é¢˜Prompt.md           # åˆ¤é¢˜æç¤ºè¯
â”‚   â”œâ”€â”€ è§£é¢˜Prompt.md           # è§£é¢˜æç¤ºè¯
â”‚   â””â”€â”€ é«˜è´¨é‡é¢˜ç›®ç¤ºä¾‹.md       # 5é“å®Œæ•´ç¤ºä¾‹
â”‚
â””â”€â”€ logs/                       # æ—¥å¿—ç›®å½•ï¼ˆä¸æäº¤Gitï¼‰
    â””â”€â”€ system.log
```

## é…ç½®è¯´æ˜

### config.yaml å…³é”®å‚æ•°

```yaml
# APIæ¨¡å‹é…ç½®
generation_model: "gemini/gemini-2.5-pro-latest"  # ç”Ÿæˆé¢˜ç›®
grading_model: "gemini/gemini-2.5-flash-latest"   # åˆ¤é¢˜

# æœ¬åœ°æ¨¡å‹é…ç½®
lm_studio_base_url: "http://localhost:1234/v1"
lm_studio_model_name: "qwen3-8b"

# æ•°æ®è·¯å¾„ï¼ˆåŒæ•°æ®åº“ï¼‰
benchmark_bank_path: "data/benchmark_bank.jsonl"  # é”™é¢˜åº“
validation_set_path: "data/validation_set.jsonl"  # éªŒè¯é›†

# æç¤ºè¯ç›®å½•
prompts_dir: "docs"

# Few-shoté…ç½®
few_shot_count: 3                    # ä½¿ç”¨é”™é¢˜åº“ä¸­çš„ç¤ºä¾‹æ•°
few_shot_source: "benchmark_bank"    # ä»é”™é¢˜åº“æŠ½å–ï¼ˆè€ŒééªŒè¯é›†ï¼‰
```

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åˆæ¬¡è¿è¡Œ

```powershell
# åˆå§‹åŒ–ç§å­æ•°æ®
Copy-Item data/seed_examples.jsonl data/benchmark_bank.jsonl

# è¿è¡Œä¸»ç¨‹åºï¼ˆä½¿ç”¨ç§å­é¢˜ç›®ä½œä¸ºFew-shotï¼‰
python main.py

# è¾“å‡ºç¤ºä¾‹ï¼š
# ä»Benchmarké”™é¢˜åº“æŠ½å–äº† 2 é“é¢˜ç›®ä½œä¸ºFew-shotæ ·æœ¬
# ç”Ÿæˆäº† 3 ä¸ªé¢˜ç›®
# é¢˜ç›®å·²è§£ç­”
# åˆ¤é¢˜å®Œæˆ
# é”™é¢˜åº“æ–°å¢: 2 é¢˜ï¼ˆåŒ…å«é”™è¯¯ç­”æ¡ˆåŸæ–‡ï¼‰
# éªŒè¯é›†æ–°å¢: 1 é¢˜
```

### ç¤ºä¾‹2: æ‰¹é‡ç”Ÿæˆ

```powershell
# æ‰¹é‡è¿è¡Œ10ä¸ªå‘¨æœŸï¼Œæ¯å‘¨æœŸ5é¢˜
python tools/batch_run.py --cycles 10 --questions 5

# æŸ¥çœ‹ç»Ÿè®¡
python tools/analyze_data.py
```

### ç¤ºä¾‹3: Webç›‘æ§

```powershell
# å¯åŠ¨ç›‘æ§æœåŠ¡
python web_ui.py

# æµè§ˆå™¨è®¿é—® http://localhost:5000
# å®æ—¶æŸ¥çœ‹ï¼š
# - é”™é¢˜åº“æ•°é‡: 47
# - éªŒè¯é›†æ•°é‡: 23
# - APIç´¯è®¡æˆæœ¬: $1.23
```

## æŠ€æœ¯æ¶æ„

### API è°ƒç”¨é“¾

```
ç”¨æˆ· â†’ main.py
         â†“
    [ç”Ÿæˆé¢˜ç›®]
    QuestionGenerator â†’ Gemini 2.5 Pro (via LiteLLM)
         â†“
    [è§£ç­”é¢˜ç›®]
    AnsweringModule â†’ LM Studio (qwen3-8b)
         â†“
    [æ™ºèƒ½åˆ¤é¢˜]
    GradingModule â†’ Gemini 2.5 Flash (via LiteLLM)
         â†“
    [åˆ†ç±»ä¿å­˜]
    DataPersistence â†’ benchmark_bank.jsonl / validation_set.jsonl
```

### æ•°æ®æµ

```
Few-shotç¤ºä¾‹ (ä»validation_setæŠ½å–)
    â†“
ç”Ÿæˆæ–°é¢˜ç›® (topic, difficulty, type, question_text, standard_answer)
    â†“
æœ¬åœ°æ¨¡å‹è§£ç­”
    â†“
åˆ¤é¢˜ (is_correct, score, reasoning)
    â†“
    â”œâ”€ [ä¸æ­£ç¡®] â†’ BenchmarkEntry {question_data, failed_attempt, grading_result}
    â”‚                  â†“
    â”‚            benchmark_bank.jsonl
    â”‚
    â””â”€ [æ­£ç¡®] â†’ QuestionUnit â†’ validation_set.jsonl
```

## å¼€å‘å‡†åˆ™

æœ¬é¡¹ç›®ä¸¥æ ¼éµå¾ªä»¥ä¸‹å¼€å‘å‡†åˆ™ï¼š

1. **æ–‡æ¡£ç®¡ç†**: æ‰€æœ‰ `.md` æ–‡æ¡£ç»Ÿä¸€æ”¾ç½®åœ¨ `docs/` ç›®å½•
2. **ä»£ç ç»„ç»‡**: æ ¸å¿ƒä»£ç åœ¨ `src/`ï¼Œå·¥å…·è„šæœ¬åœ¨ `tools/`ï¼Œæµ‹è¯•åœ¨ `testscript/`
3. **æç¤ºè¯åˆ†ç¦»**: æ‰€æœ‰ Prompt ç‹¬ç«‹å­˜å‚¨ä¸º `.md` æ–‡ä»¶ï¼Œç”± `PromptManager` åŠ¨æ€åŠ è½½
4. **åŒæ•°æ®åº“**: é”™é¢˜åº“å’ŒéªŒè¯é›†åˆ†åˆ«ç®¡ç†ï¼Œå®ç°åŒé‡èµ„äº§ç§¯ç´¯
5. **æˆæœ¬æ§åˆ¶**: API è°ƒç”¨å‰ä¼°ç®—æˆæœ¬ï¼ˆä½¿ç”¨ LiteLLM çš„æˆæœ¬è¿½è¸ªï¼‰
6. **Git ç®¡ç†**: åŠæ—¶æäº¤åˆ° `git@github.com:Sithcighce/distillation_generation.git`

è¯¦è§ `docs/å¼€å‘å‡†åˆ™.md`ã€‚

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ›´æ–°æç¤ºè¯ï¼Ÿ
A: ç›´æ¥ç¼–è¾‘ `docs/` ç›®å½•ä¸‹çš„å¯¹åº” `.md` æ–‡ä»¶ï¼ˆå¦‚ `ç”Ÿæˆé¢˜Prompt.md`ï¼‰ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚

### Q: å¦‚ä½•åˆ‡æ¢ç”Ÿæˆæ¨¡å‹ï¼Ÿ
A: ä¿®æ”¹ `config.yaml` ä¸­çš„ `generation_model` å‚æ•°ã€‚

### Q: é”™é¢˜åº“å’ŒéªŒè¯é›†çš„åŒºåˆ«ï¼Ÿ
A: 
- **é”™é¢˜åº“ (benchmark_bank.jsonl)**: ç›®æ ‡æ¨¡å‹ç­”é”™çš„é¢˜ï¼ŒåŒ…å«**é”™è¯¯ç­”æ¡ˆåŸæ–‡**å’Œåˆ¤é¢˜ç»“æœï¼Œç”¨äºæ„å»ºbenchmarkå’Œåˆ†æå¼±ç‚¹
- **éªŒè¯é›† (validation_set.jsonl)**: ç›®æ ‡æ¨¡å‹ç­”å¯¹çš„é¢˜ï¼Œç”¨äºè´¨é‡éªŒè¯
- **Few-shotæ¥æº**: ä»**é”™é¢˜åº“**æŠ½å–ç¤ºä¾‹ï¼ˆå› ä¸ºè¿™äº›æ˜¯ç»è¿‡éªŒè¯çš„é«˜è´¨é‡éš¾é¢˜ï¼‰

### Q: æ•°æ®æ–‡ä»¶å¦‚ä½•ç®¡ç†ï¼Ÿ
A:
- `data/seed_examples.jsonl` - ç§å­ç¤ºä¾‹ï¼ˆ2é“é¢˜ï¼‰ï¼Œ**æäº¤åˆ°Git**ä¾›æ–°ç”¨æˆ·ä½¿ç”¨
- `data/benchmark_bank.jsonl` - è¿è¡Œæ—¶é”™é¢˜åº“ï¼Œ**ä¸æäº¤Git**ï¼ˆåœ¨.gitignoreä¸­æ’é™¤ï¼‰
- `data/validation_set.jsonl` - è¿è¡Œæ—¶éªŒè¯é›†ï¼Œ**ä¸æäº¤Git**
- æ–°ç”¨æˆ·é¦–æ¬¡è¿è¡Œéœ€è¦å¤åˆ¶ç§å­ç¤ºä¾‹åˆå§‹åŒ–benchmark

### Q: å¦‚ä½•æŸ¥çœ‹ API æˆæœ¬ï¼Ÿ
A: è¿è¡Œ `python web_ui.py`ï¼Œè®¿é—® http://localhost:5000 æŸ¥çœ‹å®æ—¶æˆæœ¬ã€‚

## è´¡çŒ®ä¸ç»´æŠ¤

- **é¡¹ç›®ç»´æŠ¤**: éµå¾ªå¼€å‘å‡†åˆ™ï¼Œä¿æŒä»£ç æ•´æ´
- **æ•°æ®å¤‡ä»½**: å®šæœŸå¤‡ä»½ `data/` ç›®å½•
- **Git æäº¤**: ä½¿ç”¨æ¸…æ™°çš„ commit message

## è®¸å¯è¯

MIT License

---

**ç³»ç»Ÿç‰ˆæœ¬**: v2.0 (åŒé‡èµ„äº§ç§¯ç´¯æ¶æ„)  
**æœ€åæ›´æ–°**: 2025å¹´

