# QA生成系统 - Prompt模板

## 生成题目的Prompt（改进版）

```markdown
# ROLE
你是燃烧科学和工程热物理领域的资深专家，擅长基于科研文献设计高质量的评测题目。

# TASK
基于以下PECS（Progress in Energy and Combustion Science）综述论文，生成**20道**高质量问题。

---

## ✅ 题目必须满足的要求

### 1. 基于论文但独立于论文
- ✅ 问题基于论文中的概念、原理、机制
- ✅ 但**不问论文本身**（❌ "这篇文章讨论了什么？" "作者提出了哪些观点？"）
- ✅ 题目应该测试**领域知识**，而非"阅读理解"

### 2. 答案明确可判
- ✅ 有明确的对/错标准
- ✅ 优先：计算题、判断题、因果推理题
- ❌ 避免：开放性讨论题（"如何优化XX？"）、趋势预测题（"未来XX技术将如何发展？"）

### 3. 时效性无关
- ✅ 基于物理原理、化学机制、数学关系
- ❌ 避免：特定年份的技术应用、最新进展、工业现状（"2024年XX技术在XX领域的应用"）

### 4. 深度优先
- ✅ 需要理解**为什么**、**机制是什么**、**如何推导**
- ❌ 避免：纯记忆性定义题（"什么是点火延迟？"）
- ✅ 鼓励：机制解释题（"为什么压力增加会缩短点火延迟？"）

---

## 📊 题目类型分布

### **reasoning（推理分析）- 50%**（最重要）
- 因果推理："为什么X会导致Y？"
- 机制解释："X现象的物理/化学机制是什么？"
- 参数影响："改变X如何影响Y？通过什么途径？"

**示例**：
```
Q: 为什么增加压力会缩短点火延迟时间？请从分子碰撞角度解释。
A: 压力增加提高了分子数密度，导致碰撞频率上升。根据Arrhenius定律，
   反应速率正比于碰撞频率，因此化学反应加速，点火延迟时间缩短。
   定量上，点火延迟τ ∝ P^(-n)，其中n通常为1-2。
```

### **concept（概念理解）- 25%**
- 关键概念的深层含义（不是简单定义）
- 概念间的关系和区别
- 可以是"名词解释"，但要求深入

**示例**：
```
Q: 层流火焰速度（laminar flame speed）和火焰传播速度（flame propagation speed）
   有何区别？在湍流燃烧中，哪个更relevant？
A: 层流火焰速度是未燃混合物相对于火焰锋面的法向速度，是混合物的热化学性质。
   火焰传播速度是火焰锋面在空间中的移动速度，受湍流、拉伸等影响。
   湍流燃烧中，火焰传播速度更relevant，因为湍流会显著增强传播速度，
   但层流火焰速度仍是基础参数。
```

### **calculation（计算）- 15%**
- 定量推理
- 数量级估算
- 参数计算

**示例**：
```
Q: 某甲烷-空气混合物（φ=1.0）在300K、1atm下的层流火焰速度约为0.4 m/s。
   如果压力增加到10 atm，温度升至600K，估算新的火焰速度（已知SL ∝ T^α P^β，
   α≈2, β≈-0.5）。
A: SL,new = SL,ref × (T_new/T_ref)^α × (P_new/P_ref)^β
         = 0.4 × (600/300)^2 × (10/1)^(-0.5)
         = 0.4 × 4 × 0.316 ≈ 0.5 m/s
```

### **application（应用）- 10%**
- 原理应用到具体场景
- 但必须有明确答案，不能太开放

**示例**：
```
Q: 在设计HCCI发动机时，为什么需要精确控制进气温度？
   （从点火机制角度回答）
A: HCCI依赖自燃点火，点火时刻由混合物的化学动力学决定。进气温度直接影响
   压缩终了温度，进而影响点火延迟。温度偏差5-10K可能导致点火时刻提前/推迟
   数个曲轴角度，影响燃烧相位和性能。因此需要精确控制（通常±2K以内）。
```

---

## 🎯 难度分级（1-5）

**分布要求**：
- difficulty 3-4: 70%（主体）
- difficulty 5: 20%（挑战性）
- difficulty 1-2: 10%（基础）

**难度定义**：
- **3**: 需要理解单个概念的机制
- **4**: 需要综合多个概念，或涉及定量推理
- **5**: 需要深入分析、跨领域知识、或复杂推导

---

## ❌ 严格避免的题型

### 类型1：论文元信息题
```
❌ "这篇综述讨论了哪些燃烧模式？"
❌ "作者在第3节提出了什么观点？"
❌ "论文引用了哪些经典模型？"
```

### 类型2：开放性/主观题
```
❌ "如何优化柴油机的NOx排放？"（太开放，答案不唯一）
❌ "未来HCCI技术的发展方向是什么？"（预测性，会过时）
❌ "讨论机器学习在燃烧中的潜力"（太宽泛）
```

### 类型3：纯定义背诵题
```
❌ "什么是点火延迟时间？"（百度能查到）
✅ "为什么点火延迟时间随温度升高呈非单调变化？"（需理解NTC区）
```

### 类型4：时效性强的题
```
❌ "2024年电动汽车对内燃机的影响"
❌ "当前工业界常用的NOx后处理技术"
```

---

## 📋 输出格式（JSON）

```json
[
  {
    "question_text": "为什么增加压力会缩短点火延迟时间？请从分子碰撞和化学动力学角度解释。",
    "standard_answer": "压力增加提高了分子数密度，导致碰撞频率按P正比上升。根据Arrhenius定律，反应速率k正比于碰撞频率和活化能指数项。高压下，基元反应速率加快，链式反应加速推进，导致点火延迟时间τ缩短。定量关系为τ ∝ P^(-n)，其中n取决于反应机理，通常在1-2之间。此外，高压下三体反应的贡献增强，进一步加速点火过程。",
    "type": "reasoning",
    "difficulty": 3,
    "topic": "ignition_kinetics"
  },
  {
    "question_text": "某甲烷-空气混合物在300K、1atm下层流火焰速度为0.4 m/s。若压力升至10 atm，温度升至600K，估算火焰速度。已知SL ∝ T^2 P^(-0.5)。",
    "standard_answer": "根据标度关系：SL,new = SL,ref × (T_new/T_ref)^2 × (P_new/P_ref)^(-0.5) = 0.4 × (600/300)^2 × (10/1)^(-0.5) = 0.4 × 4 × 0.316 ≈ 0.5 m/s。物理解释：温度升高增强分子热运动和反应速率，使火焰速度上升；压力升高虽然加快反应，但同时增加热容使温度梯度变缓，综合效应使火焰速度略有下降（负指数）。",
    "type": "calculation",
    "difficulty": 4,
    "topic": "flame_speed"
  }
]
```

---

## 🔍 质量自检（生成后请确认）

- [ ] 每道题都能通过"为什么"测试（有明确的物理/化学机制）
- [ ] 答案有唯一性或可判断性（不是"看情况"）
- [ ] 没有提及"这篇论文"、"作者"、"综述"
- [ ] 没有时间相关词汇（"近年来"、"目前"、"2024"）
- [ ] 至少10道reasoning题（需要推理机制）
- [ ] difficulty 3-5占比 > 80%

---

## 论文内容
{paper_text}
```

---

## 使用说明

### 调用方式
```python
prompt = prompt_template.format(paper_text=full_text)
response = llm.generate(prompt)
questions = json.loads(response)
```

### 预期输出
- 20道JSON格式的题目
- reasoning类型 ≥ 10道
- difficulty 3-5 ≥ 16道
- 每道题包含完整的standard_answer